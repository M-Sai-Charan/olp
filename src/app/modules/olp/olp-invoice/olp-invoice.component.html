<!-- Branded Header -->
<div
  class="header invoice-header flex align-items-center justify-content-between mb-4 p-3 bg-primary text-white border-round shadow-2">
  <img src="https://cdn-icons-png.flaticon.com/512/2922/2922510.png" alt="Logo" height="40" class="mr-3">
  <h2>Photography OLP Invoices</h2>
  <small class="italic">Delivering timeless moments beautifully</small>
</div>

<div class="olp-invoice">
<p-tabView [(activeIndex)]="activeTabIndex" scrollable>

  <p-tabPanel *ngFor="let status of budgetStatuses" [header]="status">
    <div class="card-grid">
      <div
        class="olp-card"
        *ngFor="let olp of groupedData[status]"
        (click)="openOlpDialog(olp)"
      >
        <img class="avatar" src="assets/avatar-logo.png" alt="logo" />
        <div class="olp-id">{{ olp.olpId }}</div>
        <div class="names">{{ olp.bride }} & {{ olp.groom }}</div>
      </div>
    </div>
  </p-tabPanel>

</p-tabView>


  <!-- DIALOG FORM -->
  <p-dialog
    header="Budget Details"
    [(visible)]="dialogVisible"
    [modal]="true"
    [style]="{ width: '600px' }"
    [breakpoints]="{ '960px': '95vw' }"
  >
    <form [formGroup]="selectedForm" *ngIf="selectedForm">
      <div class="p-fluid">
        <p *ngIf="selectedOlp?.budgetStatus !== 'In-progress'" class="p-text-secondary p-mb-3">
          This entry is view-only as it is {{ selectedOlp?.budgetStatus }}.
        </p>

        <div class="p-field">
          <label>OLP ID</label>
          <input pInputText formControlName="olpId" />
        </div>

        <div formArrayName="events">
          <div *ngFor="let event of eventsFormArray.controls; let i = index" [formGroupName]="i">
            <h5 class="p-mt-3">{{ event.value.eventName }}</h5>

            <div class="p-grid">
              <div class="p-col-6">
                <label>Date</label>
                <input type="date" pInputText formControlName="eventDate" [disabled]="true" />
              </div>
              <div class="p-col-6">
                <label>Location</label>
                <input pInputText formControlName="eventLocation" [disabled]="true" />
              </div>
              <div class="p-col-6">
                <label>Time</label>
                <input pInputText formControlName="eventTime" [disabled]="true" />
              </div>
              <div class="p-col-6">
                <label>Guests</label>
                <input type="number" pInputText formControlName="eventGuests" [disabled]="true" />
              </div>
              <div class="p-col-6">
                <label>Budget</label>
                <input
                  type="number"
                  pInputText
                  formControlName="eventBudget"
                  [disabled]="selectedOlp.budgetStatus !== 'In-progress'"
                />
              </div>
            </div>
          </div>
        </div>

        <div class="p-field p-mt-3">
          <label>Budget Comments</label>
          <textarea
            pInputTextarea
            formControlName="budgetComments"
            rows="3"
            [disabled]="selectedOlp.budgetStatus !== 'In-progress'"
          ></textarea>
        </div>

        <div class="p-mt-4">
          <button
            pButton
            label="Save"
            icon="pi pi-check"
            class="p-button-success"
            (click)="saveBudget()"
            *ngIf="selectedOlp.budgetStatus === 'In-progress'"
          ></button>
        </div>
      </div>
    </form>
  </p-dialog>
</div>
